# 모델링 이야기
## 고객의 정의는?
고객 데이터는 거의 모든 조직에서 관리하고 있다. 흔히 고객유형을 자연인과 법인으로 나눈다. 자연인은 주민등록번호, 외국인등록번호, 여권번호로 식별하고, 법인은 법인등록번호로 식별한다. 식별번호나 이름 주소 등의 속성 자체만 가지고는 자연인, 법인, 단체가 크게 다르지 않다.

고객의 범주에 해당하는지를 판단하기 위해 다음의 기준을 정의했다.
1) 식별 가능한 : 주민등록번호, 여권번호, 사업자등록번호 등의 식별번호를 가진다.
2) 접촉 가능한 : 주소, 전화번호 등의 접촉 가능한 정보를 가짐
3) 지속 가능한 : 일회성 거래가 아닌 지속적인 거래를 위해 정보 관리 필요성이 있음
4) 거래 주체 : 실제 경제활동을 수행하는 단위이며 지칭할 수 있는 명칭을 가짐

## 개인정보 데이터 구조와 암호화
개인정보는 개인을 식별할 수 있는 정보를 통칭한다. 개인정보는 수집 및 저장, 이용 및 활용, 제공(위탁)/처리, 파기 등의 생명주기에 따라 데이터를 관리해야 한다. 최소한의 개인정보를 수집하고 저장할 수 있도록 데이터 모델을 설계해야하고 접근 권한 설정 및 접근 로그를 설계해야한다.
ㄷ
주민등록번호는 2014년 8월 7일 원칙적으로 수집을 금지하고 있다. 법령상 근거없이 보유하고 있는 주민등록번호도 파기해야한다. 개인정보를 수집하고 저장하는 경우 '개인정보 수집 및 이용 동의' 등의 개인정보동의 항목을 관리해야한다. 또 암호화 대상을 식별하고 정의한다. 암호화 대상은 행안부 고시 해설서와 방통위 금감원에서 기준을 제시하고 있다.

암호화할 경우 DB성능 문제를 고려해야한다. 

SELECT * FROM 고객 1)WHERE 주민등록번호= '9901011234567' 2)WHERE 주민등록번호 LIKE '990101%' 

조건1의 경우 화면으로부터 암호화한 값을 받아 비교하면 되므로 성능 문제 없이 동일한 결과를 얻을 수 있다. 조건2의 경우 암복호화 방식이 DB 함수로 제동괴는 플러그인 방식인 경우 함수기반 인덱스를 생성하여 LIKE 검색하면 된다. 하지만 API 방식이면 주민등록번호 암호화를 LIKE 검색하는 것이 불가능하다. 이 경우 생년월일 컬럼을 추가하여 해결하는 방법 밖에 없다.

*데이터 암호화 방식은 API방식(자바등 프로그래밍 언어별로 라이브러리 제공), 플러그인 방식(데이터 암복호화 처리를 위해 DB 함수제공), 하이브리드 방식(API방식, 플러그인방식을 함께 적용)이 있다. 

개인정보 파기는 DB에서 영구적으로 삭제하는 방법과 보존기한이 정해진 경우 운영DB에서 별도 파기보존 DB로 분리하여 보관하는 방법, 빅데이터 분석 등을 위해 가명, 범주화, 마스킹, 총계/평균값 대체 등으로 비식별화하여 보관하는 방법이 있다.

## 공통코드 어떻게 설계하나?
대부분의 회사에서 코드성 데이터를 관리하고 있으며 이런 데이터는 시간이 흘러도 잘 변하지 않는 특성을 가진다. 코드성 데이터를 관리하는 방법은 __공통코드 테이블에서 통합__ 하여 관리하는 방법과 __개별 테이블 형태인 목록성 코드__ 로 관리하는 방법이 있다. 공통코드는 코드, 코드명 등 비교적 간단한 속성만 관리할 때 사용하고, 목록성 코드는 자재코드, 계정코드 등 업무에서 중요하거나 비교적 많은 속성을 관리하고 데이터 간 상하 관계가 복잡한 형태를 가질 때 개별 테이블로 분리하여 관리하는 게 일반적이다.

1) 공통코드유형과 공통코드로 구성
2) 코드유형과 코드 엔티티 통합 형태
3) 코드유형과 코드 형태로 구성
4) 코드유형, 코드 간 종속 관계 형태
5) 코드의 부분집합으로 관리
6) 코드유형 간 포함관계 형태
7) 코드유형, 코드 통합 및 단일키 형태

## 시스템 사용자 및 프로그램 관리
시스템 사용자는 크게 내부 시스템을 이용하는 사용자와 홈페이지에서 회원가입을 통해 서비스를 이용하는 외부 시스템 사용자로 구분할 수 있다. 외부 시스템 사용자의 경우 회원정보와 함께 시스템을 이용하기 위한 로그인 ID, 비밀번호를 같이 등록하는 게 일반적이며, 하나의 엔티티에서 회원 정보와 시스템 사용자 정보를 같이 관리한다.

보통 SSO(Single Sign-on) 기능을 통해 한번의 사용자 인증 과정을 거쳐 여러 시스템에 접속할 수 있도록 구축되어 있으며 시스템 사용자 정보를 통합하여 관리하고 있다. 시스템에서 메뉴, 프로그램, 사용권한 정보를 관리하고 메뉴마다 권한 관리를 다르게 할 수 있으므로 메뉴권한 엔티티로 관리한다.

## 주소 코드 및 주소관리
정부에서는 2014년에 지번 주소체계 대신 도로명 주소 체계를 전면 시행하였다. 도로명 주소를 위한 시스템 구축은 도로명주소 안내시스템에서 제공하는 데이터 모델을 그대로 이용하거나 약간 변경해서 사용할 수 있다. 코드 테이블을 별도로 구축하지 않고 도로명주소 안내시스템에서 제공하는 인터페이스를 활용하여 고객 주소를 관리하는 방법도 있다.